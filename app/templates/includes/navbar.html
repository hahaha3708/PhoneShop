<nav
  class="navbar navbar-expand-lg bg-body-tertiary border-bottom sticky-top shadow-sm"
>
  <div class="container">
    <!-- Logo -->
    <a class="navbar-brand fw-bold text-primary" href="/">üì± PhoneShop</a>

    <!-- Toggle mobile -->
    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#nav"
      aria-controls="nav"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Main nav -->
    <div class="collapse navbar-collapse" id="nav">
      <!-- Left menu -->
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <!-- S·∫£n ph·∫©m -->
        <li class="nav-item">
          <a class="nav-link" href="{% url 'shop:all_items_list' %}"
            >S·∫£n ph·∫©m</a
          >
        </li>

        <!-- ƒêi·ªán tho·∫°i -->
        <li class="nav-item">
          <a
            class="nav-link"
            href="{% url 'shop:product_list' %}?category=dien-thoai"
          >
            <i class="bi bi-phone"></i> ƒêi·ªán tho·∫°i
          </a>
        </li>

        <!-- Ph·ª• ki·ªán -->
        <li class="nav-item">
          <a
            class="nav-link"
            href="{% url 'shop:accessory_list' %}?category=phu-kien"
          >
            <i class="bi bi-headphones"></i> Ph·ª• ki·ªán
          </a>
        </li>

        <!-- H√£ng -->
        {% comment %}
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            href="#"
            data-bs-toggle="dropdown"
          >
            H√£ng
          </a>
          <ul class="dropdown-menu">
            {% for c in categories %}
            <li>
              <a
                class="dropdown-item"
                href="{% url 'shop:product_list' %}?brand={{ c.slug }}"
              >
                {{ c.name }}
              </a>
            </li>
            {% endfor %}
          </ul>
        </li>
      </ul>
      {% endcomment %}
      <!-- H√£ng -->
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
          H√£ng
        </a>

        <ul class="dropdown-menu">
          {% if "/accessories" in request.path %} {# Trang ph·ª• ki·ªán ‚Üí ch·ªâ h√£ng
          ph·ª• ki·ªán #} {% for b in accessory_brands %}
          <li>
            <a
              class="dropdown-item"
              href="{% url 'shop:accessory_list' %}?brand={{ b|urlencode }}"
            >
              {{ b }}
            </a>
          </li>
          {% endfor %} {% elif "/products" in request.path %} {# Trang ƒëi·ªán
          tho·∫°i ‚Üí ch·ªâ h√£ng ƒëi·ªán tho·∫°i #} {% for b in phone_brands %}
          <li>
            <a
              class="dropdown-item"
              href="{% url 'shop:product_list' %}?brand={{ b|urlencode }}"
            >
              {{ b }}
            </a>
          </li>
          {% endfor %} {% else %} {# Trang home ‚Üí t·∫•t c·∫£ h√£ng (ƒëi·ªán tho·∫°i + ph·ª•
          ki·ªán) #} {% for b in all_brands %}
          <li>
            <a
              class="dropdown-item"
              href="{% url 'shop:all_items_list' %}?brand={{ b|urlencode }}"
            >
              {{ b }}
            </a>
          </li>
          {% endfor %} {% endif %}
        </ul>
      </li>

      <!-- Search -->
      <form
        class="d-flex me-3"
        role="search"
        action="{% url 'shop:product_list' %}"
      >
        <input
          class="form-control me-2"
          type="search"
          name="q"
          placeholder="T√¨m iPhone 15, Galaxy S24‚Ä¶"
          aria-label="Search"
          value="{{ request.GET.q }}"
        />
        <button class="btn btn-primary" type="submit">
          <i class="bi bi-search"></i>
        </button>
      </form>

      <!-- Cart -->
      <a
        href="{% url 'shop:cart' %}"
        class="btn btn-outline-secondary position-relative me-3"
      >
        <i class="bi bi-cart3"></i>
        {% if cart_count %}
        <span
          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
        >
          {{ cart_count }}
        </span>
        {% endif %}
      </a>

      <!-- Auth -->
      {% if user.is_authenticated %}
      <div class="dropdown">
        <a
          class="btn btn-outline-primary dropdown-toggle"
          href="#"
          id="userMenu"
          role="button"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <i class="bi bi-person-circle"></i> {{ user.email }}
        </a>
        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu">
          <li>
            <a class="dropdown-item" href="#">Th√¥ng tin t√†i kho·∫£n</a>
          </li>
          <li>
            <a class="dropdown-item" href="#">L·ªãch s·ª≠ ƒë∆°n h√†ng</a>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li>
            <a class="dropdown-item" href="{% url 'shop:logout' %}">ƒêƒÉng xu·∫•t</a>
          </li>
        </ul>
      </div>
      {% else %}
      <button
        class="btn btn-outline-primary"
        data-bs-toggle="modal"
        data-bs-target="#authModal"
      >
        <i class="bi bi-person-circle"></i> ƒêƒÉng nh·∫≠p
      </button>
      {% endif %}
    </div>
  </div>
</nav>

<!-- Modal Login/Register -->
<div
  class="modal fade"
  id="authModal"
  tabindex="-1"
  aria-labelledby="authModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content shadow-lg">
      <div class="modal-header">
        <h5 class="modal-title" id="authModalLabel">Ch√†o m·ª´ng b·∫°n</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <div class="d-flex flex-column gap-3 text-center">
          <a href="{% url 'shop:login' %}" class="btn btn-primary btn-lg"
            >ƒêƒÉng nh·∫≠p</a
          >
          <a
            href="{% url 'shop:signup' %}"
            class="btn btn-outline-secondary btn-lg"
            >ƒêƒÉng k√Ω</a
          >
        </div>
      </div>
    </div>
  </div>
</div>
